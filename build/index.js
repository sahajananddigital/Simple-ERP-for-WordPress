(()=>{"use strict";var e={338:(e,t,a)=>{var n=a(795);t.H=n.createRoot,n.hydrateRoot},795:e=>{e.exports=window.ReactDOM}},t={};function a(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n=a(338);const s=window.wp.element,r=window.wp.i18n,l=window.wp.components,i=window.wp.apiFetch;var o=a.n(i);const d=async(e={})=>{try{const t=new URLSearchParams(e).toString();return await o()({path:`/wp-erp/v1/crm/contacts?${t}`})}catch(e){throw new Error(e.message||(0,r.__)("Failed to fetch contacts","wp-erp"))}},c=e=>{switch(e){case"customer":return"#00a32a";case"opportunity":return"#2271b1";default:return"#dba617"}},p=window.ReactJSXRuntime,x=({title:e,isOpen:t,onClose:a,onSave:n,data:i,fields:o})=>{const[d,c]=(0,s.useState)({}),[x,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i&&c({...i})},[i]);const u=(e,t)=>{c({...d,[e]:t})};return t?(0,p.jsx)(l.Modal,{title:e,onRequestClose:a,children:(0,p.jsxs)("div",{style:{padding:"0 16px 16px"},children:[o.map(e=>(0,p.jsxs)("div",{style:{marginBottom:"16px"},children:["text"===e.type&&(0,p.jsx)(l.TextControl,{label:e.label,value:d[e.key]||"",onChange:t=>u(e.key,t),type:e.inputType||"text"}),"textarea"===e.type&&(0,p.jsx)(l.TextareaControl,{label:e.label,value:d[e.key]||"",onChange:t=>u(e.key,t)}),"select"===e.type&&(0,p.jsx)(l.SelectControl,{label:e.label,value:d[e.key]||"",options:e.options,onChange:t=>u(e.key,t)})]},e.key)),(0,p.jsxs)(l.Flex,{justify:"flex-end",style:{marginTop:"24px"},children:[(0,p.jsx)(l.Button,{variant:"secondary",onClick:a,disabled:x,style:{marginRight:"8px"},children:(0,r.__)("Cancel","wp-erp")}),(0,p.jsx)(l.Button,{variant:"primary",onClick:async()=>{h(!0),await n(d),h(!1),a()},isBusy:x,children:(0,r.__)("Save Changes","wp-erp")})]})]})}):null},h=({contacts:e,loading:t,onContactUpdated:a})=>{const[n,i]=(0,s.useState)(!1),[d,h]=(0,s.useState)(null);if(t)return(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})});if(0===e.length)return(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No contacts found.","wp-erp")});const u=[{key:"first_name",label:(0,r.__)("First Name","wp-erp"),type:"text"},{key:"last_name",label:(0,r.__)("Last Name","wp-erp"),type:"text"},{key:"email",label:(0,r.__)("Email","wp-erp"),type:"text",inputType:"email"},{key:"phone",label:(0,r.__)("Phone","wp-erp"),type:"text",inputType:"tel"},{key:"company",label:(0,r.__)("Company","wp-erp"),type:"text"},{key:"status",label:(0,r.__)("Status","wp-erp"),type:"select",options:[{label:"Lead",value:"lead"},{label:"Customer",value:"customer"},{label:"Opportunity",value:"opportunity"}]},{key:"address_line_1",label:(0,r.__)("Address Line 1","wp-erp"),type:"text"},{key:"address_line_2",label:(0,r.__)("Address Line 2","wp-erp"),type:"text"},{key:"city",label:(0,r.__)("City","wp-erp"),type:"text"},{key:"state",label:(0,r.__)("State","wp-erp"),type:"text"},{key:"postal_code",label:(0,r.__)("Postal Code","wp-erp"),type:"text"},{key:"country",label:(0,r.__)("Country","wp-erp"),type:"text"},{key:"birthday",label:(0,r.__)("Birthday","wp-erp"),type:"text",inputType:"date"},{key:"anniversary",label:(0,r.__)("Anniversary","wp-erp"),type:"text",inputType:"date"}];return(0,p.jsxs)("div",{style:{overflowX:"auto"},children:[(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("ID","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Name","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Email","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Phone","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Company","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Status","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Actions","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:e.id}),(0,p.jsx)("td",{children:(0,p.jsxs)("strong",{children:[e.first_name," ",e.last_name]})}),(0,p.jsx)("td",{children:e.email||"-"}),(0,p.jsx)("td",{children:e.phone||"-"}),(0,p.jsx)("td",{children:e.company||"-"}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:c(e.status),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.status})}),(0,p.jsx)("td",{children:(0,p.jsx)(l.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{h(e),i(!0)})(e),children:(0,r.__)("Edit","wp-erp")})})]},e.id))})]}),(0,p.jsx)(x,{title:(0,r.__)("Edit Contact","wp-erp"),isOpen:n,onClose:()=>i(!1),onSave:async e=>{try{await(async e=>{try{const t=e.id;return await o()({path:`/wp-erp/v1/crm/contacts/${t}`,method:"POST",data:e})}catch(e){throw new Error(e.message||(0,r.__)("Failed to update contact","wp-erp"))}})(e),a&&a()}catch(e){console.error(e)}},data:d,fields:u})]})},u=({onContactCreated:e})=>{const[t,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),[d,c]=(0,s.useState)({first_name:"",last_name:"",email:"",phone:"",company:"",status:"lead",type:"contact",address_line_1:"",address_line_2:"",city:"",state:"",postal_code:"",country:"",birthday:"",anniversary:""});return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>i(null),children:n}),(0,p.jsxs)(l.Card,{style:{marginBottom:"24px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Add New Contact","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:async t=>{t.preventDefault(),a(!0),i(null);try{await(async e=>{try{return await o()({path:"/wp-erp/v1/crm/contacts",method:"POST",data:e})}catch(e){throw new Error(e.message||(0,r.__)("Failed to create contact","wp-erp"))}})(d),c({first_name:"",last_name:"",email:"",phone:"",company:"",status:"lead",type:"contact",address_line_1:"",address_line_2:"",city:"",state:"",postal_code:"",country:"",birthday:"",anniversary:""}),e&&e()}catch(e){i(e.message)}finally{a(!1)}},children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("First Name","wp-erp"),value:d.first_name,onChange:e=>c({...d,first_name:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Last Name","wp-erp"),value:d.last_name,onChange:e=>c({...d,last_name:e}),required:!0})})]}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Email","wp-erp"),type:"email",value:d.email,onChange:e=>c({...d,email:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Phone","wp-erp"),value:d.phone,onChange:e=>c({...d,phone:e})})})]}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Company","wp-erp"),value:d.company,onChange:e=>c({...d,company:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Status","wp-erp"),value:d.status,options:[{label:(0,r.__)("Lead","wp-erp"),value:"lead"},{label:(0,r.__)("Customer","wp-erp"),value:"customer"},{label:(0,r.__)("Opportunity","wp-erp"),value:"opportunity"}],onChange:e=>c({...d,status:e})})})]}),(0,p.jsx)("hr",{}),(0,p.jsx)("h3",{children:(0,r.__)("Contact Details","wp-erp")}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Address Line 1","wp-erp"),value:d.address_line_1,onChange:e=>c({...d,address_line_1:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Address Line 2","wp-erp"),value:d.address_line_2,onChange:e=>c({...d,address_line_2:e})})})]}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("City","wp-erp"),value:d.city,onChange:e=>c({...d,city:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("State/Province","wp-erp"),value:d.state,onChange:e=>c({...d,state:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Postal Code","wp-erp"),value:d.postal_code,onChange:e=>c({...d,postal_code:e})})})]}),(0,p.jsx)(l.Flex,{children:(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Country","wp-erp"),value:d.country,onChange:e=>c({...d,country:e})})})}),(0,p.jsx)("hr",{}),(0,p.jsx)("h3",{children:(0,r.__)("Important Dates","wp-erp")}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Birthday","wp-erp"),type:"date",value:d.birthday,onChange:e=>c({...d,birthday:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Anniversary","wp-erp"),type:"date",value:d.anniversary,onChange:e=>c({...d,anniversary:e})})})]}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:t,children:(0,r.__)("Add Contact","wp-erp")})})]})})})]})]})},j=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),[c,x]=(0,s.useState)("all"),[h,u]=(0,s.useState)("all"),[j,_]=(0,s.useState)(""),[m]=(0,s.useState)([{label:(0,r.__)("All Months","wp-erp"),value:""},{label:"January",value:"1"},{label:"February",value:"2"},{label:"March",value:"3"},{label:"April",value:"4"},{label:"May",value:"5"},{label:"June",value:"6"},{label:"July",value:"7"},{label:"August",value:"8"},{label:"September",value:"9"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]),y=async()=>{n(!0);try{const e={search:i,status:c,type:h,birthday_month:j};Object.keys(e).forEach(t=>""===e[t]&&delete e[t]);const a=await d(e);t(a)}catch(e){console.error(e)}finally{n(!1)}};return(0,s.useEffect)(()=>{y()},[]),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h3",{children:(0,r.__)("Contact Reports","wp-erp")})}),(0,p.jsxs)(l.CardBody,{children:[(0,p.jsx)("div",{style:{marginBottom:"20px",padding:"15px",background:"#f8f9fa",borderRadius:"4px"},children:(0,p.jsxs)(l.Flex,{gap:4,wrap:!0,align:"end",children:[(0,p.jsx)(l.FlexItem,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Search","wp-erp"),value:i,onChange:o,placeholder:"Name, Email, Phone..."})}),(0,p.jsx)(l.FlexItem,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Status","wp-erp"),value:c,options:[{label:"All",value:"all"},{label:"Lead",value:"lead"},{label:"Customer",value:"customer"},{label:"Opportunity",value:"opportunity"},{label:"Subscriber",value:"subscriber"}],onChange:x})}),(0,p.jsx)(l.FlexItem,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Type","wp-erp"),value:h,options:[{label:"All",value:"all"},{label:"Contact",value:"contact"},{label:"Company",value:"company"}],onChange:u})}),(0,p.jsx)(l.FlexItem,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Birthday Month","wp-erp"),value:j,options:m,onChange:_})}),(0,p.jsx)(l.FlexItem,{children:(0,p.jsx)(l.Button,{variant:"primary",onClick:y,isBusy:a,children:(0,r.__)("Filter","wp-erp")})})]})}),a?(0,p.jsx)(l.Flex,{justify:"center",children:(0,p.jsx)(l.Spinner,{})}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("p",{children:["Total Records: ",e.length]}),(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"ID"}),(0,p.jsx)("th",{children:"Name"}),(0,p.jsx)("th",{children:"Email"}),(0,p.jsx)("th",{children:"Phone"}),(0,p.jsx)("th",{children:"Status"}),(0,p.jsx)("th",{children:"Joined"})]})}),(0,p.jsx)("tbody",{children:e.length>0?e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:e.id}),(0,p.jsxs)("td",{children:[e.first_name," ",e.last_name]}),(0,p.jsx)("td",{children:e.email}),(0,p.jsx)("td",{children:e.phone}),(0,p.jsx)("td",{children:e.status}),(0,p.jsx)("td",{children:new Date(e.created_at).toLocaleDateString()})]},e.id)):(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:"6",children:"No records found."})})})]})]})]})]})},_=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!0),[i,o]=(0,s.useState)(null);(0,s.useEffect)(()=>{c()},[]);const c=async()=>{n(!0),o(null);try{const e=await d();t(e)}catch(e){o(e.message)}finally{n(!1)}},x=()=>{c()};return(0,p.jsxs)("div",{className:"wp-erp-crm",style:{padding:"16px"},children:[i&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>o(null),children:i}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("CRM Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-crm-tabs",activeClass:"is-active",initialTabName:"contacts",tabs:[{name:"contacts",title:(0,r.__)("Contacts","wp-erp"),className:"tab-contacts"},{name:"reports",title:(0,r.__)("Reports","wp-erp"),className:"tab-reports"}],children:t=>(0,p.jsxs)(p.Fragment,{children:["contacts"===t.name&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u,{onContactCreated:x}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Contacts","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(h,{contacts:e,loading:a})})]})]}),"reports"===t.name&&(0,p.jsx)(j,{})]})})})]})]})},m=({accounts:e,loading:t})=>t?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===e.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No accounts found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Code","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Name","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Type","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Balance","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.code})}),(0,p.jsx)("td",{children:e.name}),(0,p.jsx)("td",{children:e.type}),(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.balance})})]},e.id))})]})}),y=({transactions:e,loading:t})=>{const[a,n]=(0,s.useState)(null);return t?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===e.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No transactions found.","wp-erp")}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Voucher No","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Type","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Reference","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Total","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Actions","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.voucher_no})}),(0,p.jsx)("td",{children:e.type}),(0,p.jsx)("td",{children:e.date}),(0,p.jsx)("td",{children:e.reference||"-"}),(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.total})}),(0,p.jsx)("td",{children:(0,p.jsx)(l.Button,{variant:"secondary",onClick:()=>n(e),isSmall:!0,children:(0,r.__)("View","wp-erp")})})]},e.id))})]})}),a&&(0,p.jsx)(l.Modal,{title:(0,r.__)("Transaction Details","wp-erp"),onRequestClose:()=>n(null),children:(0,p.jsxs)("div",{style:{padding:"16px"},children:[(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:(0,r.__)("Voucher No:","wp-erp")})," ",a.voucher_no]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:(0,r.__)("Type:","wp-erp")})," ",a.type]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:(0,r.__)("Date:","wp-erp")})," ",a.date]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:(0,r.__)("Reference:","wp-erp")})," ",a.reference||"-"]}),(0,p.jsxs)("p",{children:[(0,p.jsx)("strong",{children:(0,r.__)("Total:","wp-erp")})," ",a.total]}),(0,p.jsx)(l.Flex,{justify:"flex-end",style:{marginTop:"24px"},children:(0,p.jsx)(l.Button,{variant:"primary",onClick:()=>n(null),children:(0,r.__)("Close","wp-erp")})})]})})]})},w=({onTransactionCreated:e})=>{const[t,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),[d,c]=(0,s.useState)({voucher_no:"",type:"payment",date:(new Date).toISOString().split("T")[0],reference:"",total:"",description:""});return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>i(null),children:n}),(0,p.jsxs)(l.Card,{style:{marginBottom:"24px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Create Transaction","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:async t=>{t.preventDefault(),a(!0),i(null);try{await(async e=>{try{return await o()({path:"/wp-erp/v1/accounting/transactions",method:"POST",data:e})}catch(e){throw new Error(e.message||(0,r.__)("Failed to create transaction","wp-erp"))}})(d),c({voucher_no:"",type:"payment",date:(new Date).toISOString().split("T")[0],reference:"",total:"",description:""}),e&&e()}catch(e){i(e.message)}finally{a(!1)}},children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Voucher No","wp-erp"),value:d.voucher_no,onChange:e=>c({...d,voucher_no:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Type","wp-erp"),value:d.type,options:[{label:(0,r.__)("Payment","wp-erp"),value:"payment"},{label:(0,r.__)("Receipt","wp-erp"),value:"receipt"},{label:(0,r.__)("Journal","wp-erp"),value:"journal"}],onChange:e=>c({...d,type:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Date","wp-erp"),type:"date",value:d.date,onChange:e=>c({...d,date:e}),required:!0})})]}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Reference","wp-erp"),value:d.reference,onChange:e=>c({...d,reference:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Total","wp-erp"),type:"number",step:"0.01",value:d.total,onChange:e=>c({...d,total:e}),required:!0})})]}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Description","wp-erp"),value:d.description,onChange:e=>c({...d,description:e}),rows:4})}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:t,children:(0,r.__)("Create Transaction","wp-erp")})})]})})})]})]})},g=({view:e="accounts"})=>{const[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[d,c]=(0,s.useState)(!0),[x,h]=(0,s.useState)(null),[u,j]=(0,s.useState)("transactions"===e?"transactions":"accounts");(0,s.useEffect)(()=>{"accounts"===u?_():g()},[u]);const _=async()=>{c(!0),h(null);try{const e=await(async()=>{try{return await o()({path:"/wp-erp/v1/accounting/accounts"})}catch(e){throw new Error(e.message||(0,r.__)("Failed to fetch accounts","wp-erp"))}})();a(e)}catch(e){h(e.message)}finally{c(!1)}},g=async()=>{c(!0),h(null);try{const e=await(async()=>{try{return await o()({path:"/wp-erp/v1/accounting/transactions"})}catch(e){throw new Error(e.message||(0,r.__)("Failed to fetch transactions","wp-erp"))}})();i(e)}catch(e){h(e.message)}finally{c(!1)}},b=()=>{"transactions"!==u?j("transactions"):g()};return(0,p.jsxs)("div",{className:"wp-erp-accounting",style:{padding:"16px"},children:[x&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>h(null),children:x}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Accounting","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-accounting-tabs",activeClass:"is-active",initialTabName:u,onSelect:e=>j(e),tabs:[{name:"accounts",title:(0,r.__)("Chart of Accounts","wp-erp"),className:"tab-accounts"},{name:"transactions",title:(0,r.__)("Transactions","wp-erp"),className:"tab-transactions"},{name:"create",title:(0,r.__)("Create Transaction","wp-erp"),className:"tab-create"}],children:e=>"accounts"===e.name?(0,p.jsx)(m,{accounts:t,loading:d}):"transactions"===e.name?(0,p.jsx)(y,{transactions:n,loading:d}):(0,p.jsx)(w,{onTransactionCreated:b})})})]})]})},b=({view:e="employees"})=>{const[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),[x,h]=(0,s.useState)(e);(0,s.useEffect)(()=>{"employees"===x&&u()},[x]);const u=async()=>{i(!0),c(null);try{const e=await o()({path:"/wp-erp/v1/hr/employees"});a(e)}catch(e){c(e.message||(0,r.__)("Failed to fetch employees","wp-erp"))}finally{i(!1)}};return(0,p.jsxs)("div",{className:"wp-erp-hr",style:{padding:"16px"},children:[d&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>c(null),children:d}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("HR Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-hr-tabs",activeClass:"is-active",initialTabName:x,onSelect:e=>h(e),tabs:[{name:"employees",title:(0,r.__)("Employees","wp-erp"),className:"tab-employees"},{name:"leaves",title:(0,r.__)("Leave Requests","wp-erp"),className:"tab-leaves"}],children:e=>"employees"===e.name?n?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===t.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No employees found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Employee ID","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Name","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Designation","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Department","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Status","wp-erp")})]})}),(0,p.jsx)("tbody",{children:t.map(e=>{return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.employee_id})}),(0,p.jsx)("td",{children:e.user_id?`User #${e.user_id}`:"-"}),(0,p.jsx)("td",{children:e.designation||"-"}),(0,p.jsx)("td",{children:e.department||"-"}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:(t=e.status,"active"===t?"#00a32a":"#757575"),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.status})})]},e.id);var t})})]})}):(0,p.jsx)("div",{className:"wp-erp-hr",children:(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Leave Requests","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("Leave management coming soonâ€¦","wp-erp")})})]})})})})]})]})},v=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(!0),[i,d]=(0,s.useState)(null),[c,x]=(0,s.useState)(!1),[h,u]=(0,s.useState)({subject:"",description:"",priority:"medium",status:"open"}),[j,_]=(0,s.useState)("tickets");(0,s.useEffect)(()=>{m()},[]);const m=async()=>{n(!0),d(null);try{const e=await o()({path:"/wp-erp/v1/helpdesk/tickets"});t(e)}catch(e){d(e.message||(0,r.__)("Failed to fetch tickets","wp-erp"))}finally{n(!1)}},y=async e=>{e.preventDefault(),x(!0),d(null);try{await o()({path:"/wp-erp/v1/helpdesk/tickets",method:"POST",data:h}),u({subject:"",description:"",priority:"medium",status:"open"}),m(),_("tickets")}catch(e){d(e.message||(0,r.__)("Failed to create ticket","wp-erp"))}finally{x(!1)}},w=e=>{switch(e){case"urgent":return"#d63638";case"high":return"#dba617";case"medium":return"#2271b1";default:return"#00a32a"}},g=e=>{switch(e){case"open":return"#d63638";case"closed":return"#757575";default:return"#00a32a"}};return(0,p.jsxs)("div",{className:"wp-erp-helpdesk",style:{padding:"16px"},children:[i&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>d(null),children:i}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Helpdesk Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-helpdesk-tabs",activeClass:"is-active",initialTabName:j,onSelect:e=>_(e),tabs:[{name:"tickets",title:(0,r.__)("Tickets","wp-erp"),className:"tab-tickets"},{name:"create",title:(0,r.__)("Create Ticket","wp-erp"),className:"tab-create"}],children:t=>"tickets"===t.name?a?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===e.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No tickets found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Ticket No","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Subject","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Priority","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Status","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Created","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.ticket_no})}),(0,p.jsx)("td",{children:e.subject}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:w(e.priority),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.priority})}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:g(e.status),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.status})}),(0,p.jsx)("td",{children:e.created_at})]},e.id))})]})}):(0,p.jsxs)(l.Card,{style:{marginBottom:"24px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Create New Ticket","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:y,children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Subject","wp-erp"),value:h.subject,onChange:e=>u({...h,subject:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Description","wp-erp"),value:h.description,onChange:e=>u({...h,description:e}),required:!0,rows:6})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Priority","wp-erp"),value:h.priority,options:[{label:(0,r.__)("Low","wp-erp"),value:"low"},{label:(0,r.__)("Medium","wp-erp"),value:"medium"},{label:(0,r.__)("High","wp-erp"),value:"high"},{label:(0,r.__)("Urgent","wp-erp"),value:"urgent"}],onChange:e=>u({...h,priority:e})})}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:c,children:(0,r.__)("Create Ticket","wp-erp")})})]})})})]})})})]})]})},f=({view:e="list"})=>{const[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1),[u,j]=(0,s.useState)({voucher_type:"payment",date:(new Date).toISOString().split("T")[0],party_name:"",amount:"",description:"",status:"draft"}),[_,m]=(0,s.useState)("create"===e?"create":"list");(0,s.useEffect)(()=>{"list"===_&&y()},[_]);const y=async()=>{i(!0),c(null);try{const e=await o()({path:"/wp-erp/v1/vouchers"});a(e)}catch(e){c(e.message||(0,r.__)("Failed to fetch vouchers","wp-erp"))}finally{i(!1)}},w=async e=>{e.preventDefault(),h(!0),c(null);try{await o()({path:"/wp-erp/v1/vouchers",method:"POST",data:u}),j({voucher_type:"payment",date:(new Date).toISOString().split("T")[0],party_name:"",amount:"",description:"",status:"draft"}),"create"===_?m("list"):y()}catch(e){c(e.message||(0,r.__)("Failed to create voucher","wp-erp"))}finally{h(!1)}},g=e=>{switch(e){case"approved":return"#00a32a";case"draft":return"#757575";default:return"#dba617"}};return(0,p.jsxs)("div",{className:"wp-erp-vouchers",style:{padding:"16px"},children:[d&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>c(null),children:d}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Voucher Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-vouchers-tabs",activeClass:"is-active",initialTabName:_,onSelect:e=>m(e),tabs:[{name:"list",title:(0,r.__)("All Vouchers","wp-erp"),className:"tab-list"},{name:"create",title:(0,r.__)("Create Voucher","wp-erp"),className:"tab-create"}],children:e=>"list"===e.name?n?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===t.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No vouchers found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Voucher No","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Type","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Party Name","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Amount","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Status","wp-erp")})]})}),(0,p.jsx)("tbody",{children:t.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.voucher_no})}),(0,p.jsx)("td",{children:e.voucher_type}),(0,p.jsx)("td",{children:e.date}),(0,p.jsx)("td",{children:e.party_name||"-"}),(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.amount})}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:g(e.status),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.status})})]},e.id))})]})}):(0,p.jsxs)(l.Card,{style:{marginBottom:"24px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Create New Voucher","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:w,children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Voucher Type","wp-erp"),value:u.voucher_type,options:[{label:(0,r.__)("Payment","wp-erp"),value:"payment"},{label:(0,r.__)("Receipt","wp-erp"),value:"receipt"},{label:(0,r.__)("Journal","wp-erp"),value:"journal"}],onChange:e=>j({...u,voucher_type:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Date","wp-erp"),type:"date",value:u.date,onChange:e=>j({...u,date:e}),required:!0})})]}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Party Name","wp-erp"),value:u.party_name,onChange:e=>j({...u,party_name:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Amount","wp-erp"),type:"number",step:"0.01",value:u.amount,onChange:e=>j({...u,amount:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Description","wp-erp"),value:u.description,onChange:e=>j({...u,description:e}),rows:4})}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:x,children:(0,r.__)("Create Voucher","wp-erp")})})]})})})]})})})]})]})},C=({view:e="list"})=>{const[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1),[u,j]=(0,s.useState)({contact_id:"",invoice_date:(new Date).toISOString().split("T")[0],due_date:"",subtotal:"",tax_amount:"",total_amount:"",notes:"",status:"draft"}),[_,m]=(0,s.useState)("create"===e?"create":"list");(0,s.useEffect)(()=>{"list"===_&&y()},[_]);const y=async()=>{i(!0),c(null);try{const e=await o()({path:"/wp-erp/v1/invoices"});a(e)}catch(e){c(e.message||(0,r.__)("Failed to fetch invoices","wp-erp"))}finally{i(!1)}},w=async e=>{e.preventDefault(),h(!0),c(null);try{await o()({path:"/wp-erp/v1/invoices",method:"POST",data:u}),"create"===_?m("list"):y()}catch(e){c(e.message||(0,r.__)("Failed to create invoice","wp-erp"))}finally{h(!1)}},g=e=>{switch(e){case"paid":return"#00a32a";case"draft":return"#757575";default:return"#dba617"}};return(0,p.jsxs)("div",{className:"wp-erp-invoices",style:{padding:"16px"},children:[d&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>c(null),children:d}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Invoice Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-invoices-tabs",activeClass:"is-active",initialTabName:_,onSelect:e=>m(e),tabs:[{name:"list",title:(0,r.__)("All Invoices","wp-erp"),className:"tab-list"},{name:"create",title:(0,r.__)("Create Invoice","wp-erp"),className:"tab-create"}],children:e=>"list"===e.name?n?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===t.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No invoices found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Invoice No","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Due Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Total Amount","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Status","wp-erp")})]})}),(0,p.jsx)("tbody",{children:t.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.invoice_no})}),(0,p.jsx)("td",{children:e.invoice_date}),(0,p.jsx)("td",{children:e.due_date||"-"}),(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.total_amount})}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:g(e.status),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.status})})]},e.id))})]})}):(0,p.jsxs)(l.Card,{style:{marginBottom:"24px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Create Invoice","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:w,children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Invoice Date","wp-erp"),type:"date",value:u.invoice_date,onChange:e=>j({...u,invoice_date:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Due Date","wp-erp"),type:"date",value:u.due_date,onChange:e=>j({...u,due_date:e})})})]}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Subtotal","wp-erp"),type:"number",step:"0.01",value:u.subtotal,onChange:e=>{const t=parseFloat(e)||0,a=parseFloat(u.tax_amount)||0;j({...u,subtotal:e,total_amount:(t+a).toFixed(2)})}})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Tax Amount","wp-erp"),type:"number",step:"0.01",value:u.tax_amount,onChange:e=>{const t=parseFloat(u.subtotal)||0,a=parseFloat(e)||0;j({...u,tax_amount:e,total_amount:(t+a).toFixed(2)})}})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Total Amount","wp-erp"),type:"number",step:"0.01",value:u.total_amount,readOnly:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Notes","wp-erp"),value:u.notes,onChange:e=>j({...u,notes:e}),rows:4})}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:x,children:(0,r.__)("Create Invoice","wp-erp")})})]})})})]})})})]})]})},S=e=>{switch(e){case"approved":return"#00a32a";case"rejected":return"#d63638";default:return"#dba617"}},T=({expenses:e,loading:t})=>t?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):0===e.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No expenses found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Expense No","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Type","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Amount","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Category","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Status","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.expense_no})}),(0,p.jsx)("td",{children:e.expense_type}),(0,p.jsx)("td",{children:e.date}),(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.amount})}),(0,p.jsx)("td",{children:e.category||"-"}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"2px",backgroundColor:S(e.status),color:"#fff",fontSize:"12px",textTransform:"capitalize"},children:e.status})})]},e.id))})]})}),F=({onExpenseCreated:e})=>{const[t,a]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),[d,c]=(0,s.useState)({expense_type:"general",date:(new Date).toISOString().split("T")[0],amount:"",description:"",category:"",payment_method:"cash",status:"pending"});return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>i(null),children:n}),(0,p.jsxs)(l.Card,{style:{marginBottom:"24px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Add Expense","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:async t=>{t.preventDefault(),a(!0),i(null);try{await(async e=>{try{return await o()({path:"/wp-erp/v1/expenses",method:"POST",data:e})}catch(e){throw new Error(e.message||(0,r.__)("Failed to create expense","wp-erp"))}})(d),c({expense_type:"general",date:(new Date).toISOString().split("T")[0],amount:"",description:"",category:"",payment_method:"cash",status:"pending"}),e&&e()}catch(e){i(e.message)}finally{a(!1)}},children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Expense Type","wp-erp"),value:d.expense_type,options:[{label:(0,r.__)("General","wp-erp"),value:"general"},{label:(0,r.__)("Travel","wp-erp"),value:"travel"},{label:(0,r.__)("Meals","wp-erp"),value:"meals"},{label:(0,r.__)("Office Supplies","wp-erp"),value:"office_supplies"}],onChange:e=>c({...d,expense_type:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Date","wp-erp"),type:"date",value:d.date,onChange:e=>c({...d,date:e}),required:!0})})]}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Amount","wp-erp"),type:"number",step:"0.01",value:d.amount,onChange:e=>c({...d,amount:e}),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Category","wp-erp"),value:d.category,onChange:e=>c({...d,category:e})})})]}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Payment Method","wp-erp"),value:d.payment_method,options:[{label:(0,r.__)("Cash","wp-erp"),value:"cash"},{label:(0,r.__)("Bank Transfer","wp-erp"),value:"bank_transfer"},{label:(0,r.__)("Credit Card","wp-erp"),value:"credit_card"},{label:(0,r.__)("Cheque","wp-erp"),value:"cheque"}],onChange:e=>c({...d,payment_method:e})})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Status","wp-erp"),value:d.status,options:[{label:(0,r.__)("Pending","wp-erp"),value:"pending"},{label:(0,r.__)("Approved","wp-erp"),value:"approved"},{label:(0,r.__)("Rejected","wp-erp"),value:"rejected"}],onChange:e=>c({...d,status:e})})})]}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextareaControl,{label:(0,r.__)("Description","wp-erp"),value:d.description,onChange:e=>c({...d,description:e}),rows:4})}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:t,children:(0,r.__)("Add Expense","wp-erp")})})]})})})]})]})},N=({view:e="list"})=>{const[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),[x,h]=(0,s.useState)("create"===e?"create":"list");(0,s.useEffect)(()=>{"list"===x&&u()},[x]);const u=async()=>{i(!0),c(null);try{const e=await(async()=>{try{return await o()({path:"/wp-erp/v1/expenses"})}catch(e){throw new Error(e.message||(0,r.__)("Failed to fetch expenses","wp-erp"))}})();a(e)}catch(e){c(e.message)}finally{i(!1)}},j=()=>{"list"!==x?h("list"):u()};return(0,p.jsxs)("div",{className:"wp-erp-expenses",style:{padding:"16px"},children:[d&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>c(null),children:d}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Expense Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-expenses-tabs",activeClass:"is-active",initialTabName:x,onSelect:e=>h(e),tabs:[{name:"list",title:(0,r.__)("All Expenses","wp-erp"),className:"tab-list"},{name:"create",title:(0,r.__)("Add Expense","wp-erp"),className:"tab-create"}],children:e=>"list"===e.name?(0,p.jsx)(T,{expenses:t,loading:n}):(0,p.jsx)(F,{onExpenseCreated:j})})})]})]})},k=async()=>{try{return await o()({path:"/wp-erp/v1/food-pass"})}catch(e){throw new Error(e.message||(0,r.__)("Failed to fetch food passes","wp-erp"))}},B=(e,t="food-pass")=>{const a=document.createElement("canvas"),n=a.getContext("2d"),s="donation"===t?800:600;a.width=380,a.height=s,n.fillStyle="#ffffff",n.fillRect(0,0,380,s),n.fillStyle="#000000",n.font="bold 16px monospace",n.textBaseline="top";let r=20;const l=24,i=(e,t)=>(n.textAlign="center",n.fillText(e,190,t),t+l),o=e=>(n.textAlign="center",n.fillText("---------------------------------",190,e),e+l);if("food-pass"===t){r=i("Shree Swaminarayan Gurukul",r),r=o(r),r=i("ðŸ› FOOD PASS ðŸ›",r),r=o(r),r+=10;const t=20,a=140,s=(e,s)=>{n.textAlign="left",n.fillText(e,t,r),n.fillText(" : "+s,a,r),r+=l};s("ID",e.id),s("Date",e.date),s("Time",e.time),s("Quantity",e.quantity),s("Rate",`â‚¹${e.rate}`),r=o(r),n.font="bold 20px monospace",s("Total",`â‚¹${e.amount}`),r+=30,n.font="bold 16px monospace",r=i("ðŸ™ Jay Swaminarayan ðŸ™",r)}else if("donation"===t){r=i("Shree Swaminarayan Gurukul",r),r=i("Ahmedabad - Nikol",r),r+=10,n.font="bold 20px monospace",r=i("DONATION",r),n.font="bold 16px monospace",r+=10;const t=20,a=100,s=(e,s)=>{n.textAlign="left",n.fillText(e,t,r),n.fillText(" : "+s,a,r),r+=l};s("ID",e.id),e.donor_id&&s("User ID",e.donor_id),s("Date",e.date),s("Name",e.donor_name),s("Amount",`â‚¹${e.amount}`),s("Phone",e.phone||"-"),s("Details",e.ledger||"-"),e.note&&s("Note",e.note),s("Ledger",e.ledger),r+=20,r=i("âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»âœ»",r),r+=10,n.textAlign="left",n.fillText("Gurkul Activities:",20,r),r+=l,["âœ» Morning Evening Aarti","âœ» Daily Shiramani & Pooja","âœ» Ravi Sabha","âœ» Saturday Youth Sabha","âœ» Poonam Abhishek"].forEach(e=>{n.fillText("  "+e,20,r),r+=l}),r+=20,r=i("ðŸ™ ðŸ™ Jay Swaminarayan ðŸ™ ðŸ™",r)}return a.toDataURL("image/png")},D=e=>{const t=window.open("","_blank","width=400,height=600");t?(t.document.write(`\n\t\t<html>\n\t\t\t<head>\n\t\t\t\t<title>Print Receipt</title>\n\t\t\t\t<style>\n\t\t\t\t\tbody { margin: 0; padding: 0; display: flex; justify-content: center; }\n\t\t\t\t\timg { width: 100%; max-width: 380px; height: auto; }\n\t\t\t\t\t@media print {\n\t\t\t\t\t\tbody { -webkit-print-color-adjust: exact; }\n\t\t\t\t\t}\n\t\t\t\t</style>\n\t\t\t</head>\n\t\t\t<body>\n\t\t\t\t<img src="${e}" onload="window.print(); window.close();" />\n\t\t\t</body>\n\t\t</html>\n\t`),t.document.close()):alert("Please allow popups to print the receipt.")},A=({onFoodPassCreated:e})=>{const[t,a]=(0,s.useState)(1),[n]=(0,s.useState)(90),[i,d]=(0,s.useState)(!1),[c,x]=(0,s.useState)(null),h=t*n;return(0,p.jsxs)(p.Fragment,{children:[c&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>x(null),children:c}),(0,p.jsxs)(l.Card,{style:{marginBottom:"24px",maxWidth:"400px"},children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Food Pass","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:async s=>{s.preventDefault(),d(!0),x(null);const l=new Date,i=l.toISOString().split("T")[0],c=l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),p=l.getHours()<16?"Lunch":"Dinner",u={quantity:parseInt(t),amount:h,date:i,time:c,rate:n,mealType:p,id:"PENDING..."},j={issue_date:i,valid_from:i,valid_to:i,total_meals:parseInt(t),meals_per_day:parseInt(t),status:"active",notes:JSON.stringify({amount:h,rate:n,time:c,mealType:p})};try{const t=await(async e=>{try{return await o()({path:"/wp-erp/v1/food-pass",method:"POST",data:e})}catch(e){const t=e.message&&e.data?.status?`${e.message} (${e.data.status})`:e.message||(0,r.__)("Failed to save food pass","wp-erp");throw new Error(t)}})(j);u.id=t.id;const n=B(u,"food-pass");D(n),e&&e(),a(1)}catch(e){x(e.message)}finally{d(!1)}},children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Quantity:","wp-erp"),type:"number",min:"1",value:t,onChange:e=>a(e),required:!0})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Total Amount to Pay:","wp-erp"),value:`â‚¹${h}`,readOnly:!0,help:(0,r.__)("Rate: â‚¹90 per meal","wp-erp")})}),(0,p.jsx)(l.Flex,{justify:"flex-start",children:(0,p.jsx)(l.Button,{variant:"primary",type:"submit",isBusy:i,children:(0,r.__)("Print Food Pass","wp-erp")})}),(0,p.jsx)("p",{style:{fontSize:"12px",color:"#646970",margin:0},children:(0,r.__)("Prints instantly; data queued for syncing.")})]})})})]})]})},P=({foodPasses:e,loading:t})=>{const a=(e=>{const t=new Date,a=t.toISOString().split("T")[0],n=t.getMonth(),s=t.getFullYear(),r=new Date(t.getFullYear(),t.getMonth()-1,1),l=r.getMonth(),i=r.getFullYear(),o={today:{lunch:0,dinner:0,total:0},thisMonth:{count:0,amount:0},lastMonth:{count:0,amount:0}};return e.forEach(e=>{const t=new Date(e.issue_date),r=t.getMonth(),d=t.getFullYear();let c=0,p="Lunch";try{const t=e.notes?JSON.parse(e.notes):{};c=t.amount?parseFloat(t.amount):90*(parseInt(e.total_meals)||0),t.mealType&&(p=t.mealType)}catch(t){c=90*(parseInt(e.total_meals)||0)}const x=parseInt(e.total_meals||0);e.issue_date===a&&("Lunch"===p&&(o.today.lunch+=x),"Dinner"===p&&(o.today.dinner+=x),o.today.total+=x),r===n&&d===s&&(o.thisMonth.count+=x,o.thisMonth.amount+=c),r===l&&d===i&&(o.lastMonth.count+=x,o.lastMonth.amount+=c)}),o})(e);return t?(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})}):(0,p.jsxs)("div",{children:[(0,p.jsx)(l.Card,{style:{marginBottom:"20px",backgroundColor:"#fff",border:"1px solid #e0e0e0"},children:(0,p.jsxs)(l.CardBody,{children:[(0,p.jsx)("h4",{style:{margin:"0 0 10px 0",fontSize:"13px",color:"#757575",textTransform:"uppercase"},children:(0,r.__)("Monthly Performance")}),(0,p.jsxs)(l.Flex,{gap:4,children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsxs)("div",{style:{border:"1px solid #e0e0e0",padding:"15px",borderRadius:"8px"},children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:(0,r.__)("This Month")}),(0,p.jsxs)(l.Flex,{justify:"flex-start",gap:3,align:"baseline",children:[(0,p.jsxs)("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#101517"},children:["â‚¹",a.thisMonth.amount.toLocaleString("en-IN")]}),(0,p.jsxs)("div",{style:{fontSize:"13px",color:"#757575"},children:["(",a.thisMonth.count," Passes)"]})]})]})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsxs)("div",{style:{border:"1px solid #e0e0e0",padding:"15px",borderRadius:"8px"},children:[(0,p.jsx)("div",{style:{fontSize:"12px",color:"#646970",marginBottom:"4px"},children:(0,r.__)("Last Month")}),(0,p.jsxs)(l.Flex,{justify:"flex-start",gap:3,align:"baseline",children:[(0,p.jsxs)("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#646970"},children:["â‚¹",a.lastMonth.amount.toLocaleString("en-IN")]}),(0,p.jsxs)("div",{style:{fontSize:"13px",color:"#757575"},children:["(",a.lastMonth.count," Passes)"]})]})]})})]})]})}),0===e.length?(0,p.jsx)("p",{style:{padding:"16px",textAlign:"center",color:"#757575"},children:(0,r.__)("No food passes found.","wp-erp")}):(0,p.jsx)("div",{style:{overflowX:"auto"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Pass ID","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Meal Type","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Quantity","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Amount","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>{let t="-",a="-";try{const n=e.notes?JSON.parse(e.notes):{};n.amount?t=`â‚¹${n.amount}`:e.total_meals&&(t="â‚¹"+90*e.total_meals),a=n.mealType?n.mealType:"Lunch"}catch(n){e.total_meals&&(t="â‚¹"+90*e.total_meals,a="Lunch")}return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.id})}),(0,p.jsx)("td",{children:e.issue_date}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"Lunch"===a?"#e5f5fa":"#fcf0f1",color:"Lunch"===a?"#00869d":"#d63638",fontWeight:"500"},children:a})}),(0,p.jsx)("td",{children:e.total_meals}),(0,p.jsx)("td",{children:t})]},e.id)})})]})})]})},E=({foodPasses:e})=>{const[t,a]=(0,s.useState)(""),[n,i]=(0,s.useState)(""),[o,d]=(0,s.useState)("all");(0,s.useEffect)(()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],n=new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0];a(t),i(n)},[]);const c=((e,t,a,n)=>{if(!t||!a)return[];const s=new Date(t),r=new Date(a);return r.setHours(23,59,59,999),e.filter(e=>{const t=new Date(e.issue_date);if(t<s||t>r)return!1;if("all"!==n){let t="Lunch";try{const a=e.notes?JSON.parse(e.notes):{};a.mealType&&(t=a.mealType)}catch(e){}if(t.toLowerCase()!==n.toLowerCase())return!1}return!0})})(e,t,n,o);let x=0,h=0,u=0,j=0;return c.forEach(e=>{const t=parseInt(e.total_meals||0);let a=0,n="Lunch";try{const s=e.notes?JSON.parse(e.notes):{};a=s.amount?parseFloat(s.amount):90*t,s.mealType&&(n=s.mealType)}catch(e){a=90*t}x+=t,h+=a,"Lunch"===n&&(u+=t),"Dinner"===n&&(j+=t)}),(0,p.jsxs)("div",{className:"food-pass-reports",children:[(0,p.jsx)(l.Card,{style:{marginBottom:"20px",padding:"20px"},children:(0,p.jsxs)(l.Flex,{gap:4,align:"end",wrap:!0,children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("Start Date","wp-erp"),type:"date",value:t,onChange:e=>a(e)})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(l.TextControl,{label:(0,r.__)("End Date","wp-erp"),type:"date",value:n,onChange:e=>i(e)})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsxs)("div",{className:"components-base-control",children:[(0,p.jsx)("label",{className:"components-base-control__label",style:{marginBottom:"8px",display:"block"},children:(0,r.__)("Meal Type","wp-erp")}),(0,p.jsxs)("select",{value:o,onChange:e=>d(e.target.value),style:{width:"100%",height:"40px",borderColor:"#757575",borderRadius:"4px",padding:"0 8px"},children:[(0,p.jsx)("option",{value:"all",children:(0,r.__)("All Types")}),(0,p.jsx)("option",{value:"lunch",children:(0,r.__)("Lunch")}),(0,p.jsx)("option",{value:"dinner",children:(0,r.__)("Dinner")})]})]})}),(0,p.jsx)(l.FlexBlock,{style:{flex:"0 0 auto"},children:(0,p.jsx)(l.Button,{variant:"secondary",onClick:()=>{const e=(new Date).toISOString().split("T")[0];a(e),i(e)},children:(0,r.__)("Today")})})]})}),(0,p.jsxs)(l.Flex,{gap:4,style:{marginBottom:"20px"},children:[(0,p.jsx)(l.FlexBlock,{children:(0,p.jsxs)(l.Card,{style:{padding:"20px",textAlign:"center",borderTop:"4px solid #2271b1"},children:[(0,p.jsx)("div",{style:{color:"#646970",fontSize:"13px",textTransform:"uppercase"},children:(0,r.__)("Total Revenue")}),(0,p.jsxs)("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#101517"},children:["â‚¹",h.toLocaleString("en-IN")]})]})}),(0,p.jsx)(l.FlexBlock,{children:(0,p.jsxs)(l.Card,{style:{padding:"20px",textAlign:"center",borderTop:"4px solid #00a32a"},children:[(0,p.jsx)("div",{style:{color:"#646970",fontSize:"13px",textTransform:"uppercase"},children:(0,r.__)("Passes Sold")}),(0,p.jsx)("div",{style:{fontSize:"28px",fontWeight:"bold"},children:x}),(0,p.jsxs)("div",{style:{fontSize:"12px",color:"#757575",marginTop:"4px"},children:[u," Lunch â€¢ ",j," Dinner"]})]})})]}),c.length>0?(0,p.jsx)("div",{style:{overflowX:"auto",background:"#fff",border:"1px solid #e0e0e0"},children:(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("Pass ID","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Meal Type","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Quantity","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Amount","wp-erp")})]})}),(0,p.jsx)("tbody",{children:c.map(e=>{let t="-",a="-";try{const n=e.notes?JSON.parse(e.notes):{};n.amount?t=`â‚¹${n.amount}`:e.total_meals&&(t="â‚¹"+90*e.total_meals),a=n.mealType||"Lunch"}catch(n){t="â‚¹"+90*e.total_meals,a="Lunch"}return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("strong",{children:e.id})}),(0,p.jsx)("td",{children:e.issue_date}),(0,p.jsx)("td",{children:(0,p.jsx)("span",{style:{padding:"2px 6px",borderRadius:"4px",background:"Lunch"===a?"#e5f5fa":"#fcf0f1",color:"Lunch"===a?"#00869d":"#d63638",fontWeight:"500"},children:a})}),(0,p.jsx)("td",{children:e.total_meals}),(0,p.jsx)("td",{children:t})]},e.id)})})]})}):(0,p.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#757575",background:"#fff",border:"1px solid #e0e0e0"},children:(0,r.__)("No records found for the selected range.","wp-erp")})]})},R=({view:e="create"})=>{const[t,a]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0),[o,d]=(0,s.useState)(null),[c,x]=(0,s.useState)("list"===e?"list":"create");(0,s.useEffect)(()=>{"list"!==c&&"reports"!==c||h()},[c]);const h=async()=>{i(!0),d(null);try{const e=await k();a(e)}catch(e){d(e.message)}finally{i(!1)}},u=()=>{k().then(a).catch(()=>{})};return(0,p.jsxs)("div",{className:"wp-erp-food-pass",style:{padding:"16px"},children:[o&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>d(null),children:o}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h2",{style:{margin:0},children:(0,r.__)("Food Pass Management","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)(l.TabPanel,{className:"wp-erp-food-pass-tabs",activeClass:"is-active",initialTabName:c,onSelect:e=>x(e),tabs:[{name:"create",title:(0,r.__)("Create Food Pass","wp-erp"),className:"tab-create"},{name:"list",title:(0,r.__)("All Food Passes","wp-erp"),className:"tab-list"},{name:"reports",title:(0,r.__)("Reports","wp-erp"),className:"tab-reports"}],children:e=>"list"===e.name?(0,p.jsx)(P,{foodPasses:t,loading:n}):"reports"===e.name?(0,p.jsx)(E,{foodPasses:t}):(0,p.jsx)(A,{onFoodPassCreated:u})})})]})]})},I=({ledgers:e,onDonationCreated:t})=>{const[a,n]=(0,s.useState)(!1),[i,d]=(0,s.useState)(null),[c,x]=(0,s.useState)(""),[h,u]=(0,s.useState)(""),[j,_]=(0,s.useState)(e[0]||""),[m,y]=(0,s.useState)(""),[w,g]=(0,s.useState)("");return(0,p.jsxs)(p.Fragment,{children:[i&&(0,p.jsx)(l.Notice,{status:"error",isDismissible:!1,onRemove:()=>d(null),children:i}),(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h3",{children:(0,r.__)("New Donation","wp-erp")})}),(0,p.jsx)(l.CardBody,{children:(0,p.jsx)("form",{onSubmit:async a=>{a.preventDefault(),n(!0),d(null);const s=(new Date).toISOString().split("T")[0],l={donor_name:c,phone:h,ledger:j||e[0],amount:m,notes:w,issue_date:s};try{const a=await(async e=>{try{return await o()({path:"/wp-erp/v1/donations",method:"POST",data:e})}catch(e){throw new Error(e.message||(0,r.__)("Failed to save donation","wp-erp"))}})(l),n={title:"DONATION RECEIPT",id:a.id,donor_id:a.donor_id,date:s,donor_name:c,phone:h,ledger:j||e[0],amount:m,note:w},i=B(n,"donation");D(i),x(""),u(""),y(""),g(""),t&&t(a)}catch(e){d(e.message)}finally{n(!1)}},children:(0,p.jsxs)(l.Flex,{direction:"column",gap:4,children:[(0,p.jsx)(l.TextControl,{label:(0,r.__)("Date","wp-erp"),value:(new Date).toLocaleDateString(),readOnly:!0}),(0,p.jsx)(l.TextControl,{label:(0,r.__)("Phone Number","wp-erp"),value:h,onChange:u,onBlur:async()=>{if(!h)return;const e=await(async e=>{try{return await o()({path:`/wp-erp/v1/donations/donor?phone=${e}`})}catch(e){return console.log("Donor lookup failed",e),null}})(h);e&&e.found&&e.donor_name&&x(e.donor_name)},required:!0}),(0,p.jsx)(l.TextControl,{label:(0,r.__)("Donor Name","wp-erp"),value:c,onChange:x,required:!0}),(0,p.jsx)(l.SelectControl,{label:(0,r.__)("Ledger","wp-erp"),value:j,options:e.map(e=>({label:e,value:e})),onChange:_}),(0,p.jsx)(l.TextControl,{label:(0,r.__)("Note (Optional)","wp-erp"),value:w,onChange:g}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"components-base-control__label",children:(0,r.__)("Amount","wp-erp")}),(0,p.jsx)(l.Flex,{gap:2,wrap:!0,style:{marginBottom:"10px"},children:[100,200,250,500,1e3].map(e=>(0,p.jsxs)(l.Button,{variant:parseInt(m)===e?"primary":"secondary",onClick:()=>y(e),children:["â‚¹",e]},e))}),(0,p.jsx)(l.TextControl,{placeholder:(0,r.__)("Custom Amount","wp-erp"),type:"number",value:m,onChange:y,required:!0})]}),(0,p.jsxs)("div",{style:{fontSize:"18px",fontWeight:"bold"},children:["Total: â‚¹",m||0]}),(0,p.jsx)(l.Button,{type:"submit",variant:"primary",isBusy:a,children:(0,r.__)("Print & Save","wp-erp")})]})})})]})]})},O=({donations:e,loading:t,onDonationUpdated:a})=>{const[n,i]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null);if(t&&0===e.length)return(0,p.jsx)(l.Flex,{justify:"center",style:{padding:"32px"},children:(0,p.jsx)(l.Spinner,{})});const h=[{key:"donor_name",label:(0,r.__)("Donor Name","wp-erp"),type:"text"},{key:"phone",label:(0,r.__)("Phone","wp-erp"),type:"text"},{key:"ledger",label:(0,r.__)("Ledger","wp-erp"),type:"text"},{key:"amount",label:(0,r.__)("Amount","wp-erp"),type:"text",inputType:"number"},{key:"notes",label:(0,r.__)("Notes","wp-erp"),type:"textarea"},{key:"issue_date",label:(0,r.__)("Date","wp-erp"),type:"text",inputType:"date"}];return(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h3",{children:(0,r.__)("Donation History","wp-erp")})}),(0,p.jsxs)(l.CardBody,{children:[0===e.length?(0,p.jsx)("p",{style:{textAlign:"center",color:"#757575"},children:(0,r.__)("No donations found.","wp-erp")}):(0,p.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:(0,r.__)("ID","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Date","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Donor","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Phone","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Ledger","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Amount","wp-erp")}),(0,p.jsx)("th",{children:(0,r.__)("Actions","wp-erp")})]})}),(0,p.jsx)("tbody",{children:e.map(e=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:e.id}),(0,p.jsx)("td",{children:e.issue_date}),(0,p.jsx)("td",{children:e.donor_name}),(0,p.jsx)("td",{children:e.phone}),(0,p.jsx)("td",{children:e.ledger}),(0,p.jsxs)("td",{children:["â‚¹",e.amount]}),(0,p.jsx)("td",{children:(0,p.jsx)(l.Button,{isSmall:!0,variant:"secondary",onClick:()=>(c(e),void i(!0)),children:(0,r.__)("Edit","wp-erp")})})]},e.id))})]}),(0,p.jsx)(x,{title:(0,r.__)("Edit Donation","wp-erp"),isOpen:n,onClose:()=>i(!1),onSave:async e=>{try{await(async e=>{try{const t=e.id;return await o()({path:`/wp-erp/v1/donations/${t}`,method:"POST",data:e})}catch(e){throw new Error("Failed to update donation")}})(e),a&&a()}catch(e){console.error(e)}},data:d,fields:h})]})]})},L=({ledgers:e,onLedgersUpdated:t})=>{const[a,n]=(0,s.useState)(""),[i,d]=(0,s.useState)(null),[c,x]=(0,s.useState)(!1);return(0,p.jsxs)(l.Card,{children:[(0,p.jsx)(l.CardHeader,{children:(0,p.jsx)("h3",{children:(0,r.__)("Manage Ledgers","wp-erp")})}),(0,p.jsxs)(l.CardBody,{children:[i&&(0,p.jsx)(l.Notice,{status:"error",onRemove:()=>d(null),children:i}),(0,p.jsx)("ul",{children:e.map((e,t)=>(0,p.jsx)("li",{children:e},t))}),(0,p.jsxs)(l.Flex,{children:[(0,p.jsx)(l.TextControl,{value:a,onChange:n,placeholder:(0,r.__)("New Ledger Name","wp-erp")}),(0,p.jsx)(l.Button,{variant:"secondary",onClick:async()=>{if(!a)return;x(!0),d(null);const s=[...e,a];try{await(async e=>{try{return await o()({path:"/wp-erp/v1/donations/ledgers",method:"POST",data:{ledgers:e}})}catch(e){throw new Error("Failed to save ledger")}})(s),t(s),n("")}catch(e){d(e.message)}finally{x(!1)}},isBusy:c,children:(0,r.__)("Add","wp-erp")})]})]})]})},M=()=>{const[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[i,d]=(0,s.useState)(!0),[c,x]=(0,s.useState)(null),[h,u]=(0,s.useState)("create"),[j,_]=(0,s.useState)(!1);(0,s.useEffect)(()=>{m()},[]),(0,s.useEffect)(()=>{"history"!==h||j||y()},[h,j]);const m=async()=>{const e=await(async()=>{try{return await o()({path:"/wp-erp/v1/donations/ledgers"})}catch(e){return console.error(e),[]}})();n(e)},y=async()=>{d(!0);try{const e=await(async()=>{try{return await o()({path:"/wp-erp/v1/donations"})}catch(e){throw new Error(e.message||(0,r.__)("Failed to fetch donations","wp-erp"))}})();t(e),_(!0)}catch(e){x(e.message)}finally{d(!1)}},w=a=>{j?t([a,...e]):_(!1)},g=e=>{n(e)};return(0,p.jsxs)("div",{className:"wp-erp-donations",style:{padding:"20px"},children:[c&&(0,p.jsx)(l.Notice,{status:"error",onRemove:()=>x(null),children:c}),(0,p.jsx)(l.TabPanel,{className:"wp-erp-donations-tabs",activeClass:"is-active",initialTabName:"create",onSelect:u,tabs:[{name:"create",title:"Create Donation",className:"tab-create"},{name:"history",title:"History",className:"tab-history"},{name:"settings",title:"Settings",className:"tab-settings"}],children:t=>"create"===t.name?(0,p.jsx)(I,{ledgers:a,onDonationCreated:w}):"history"===t.name?(0,p.jsx)(O,{donations:e,loading:i}):"settings"===t.name?(0,p.jsx)(L,{ledgers:a,onLedgersUpdated:g}):void 0})]})};function H(){const e=document.getElementById("wp-erp-crm-root");e&&(console.log("Mounting CRM App"),(0,n.H)(e).render((0,p.jsx)(_,{})));const t=document.getElementById("wp-erp-accounting-root");t&&(console.log("Mounting Accounting App"),(0,n.H)(t).render((0,p.jsx)(g,{})));const a=document.getElementById("wp-erp-hr-root");a&&(0,n.H)(a).render((0,p.jsx)(b,{}));const s=document.getElementById("wp-erp-helpdesk-root");s&&(0,n.H)(s).render((0,p.jsx)(v,{}));const r=document.getElementById("wp-erp-vouchers-root");r&&(0,n.H)(r).render((0,p.jsx)(f,{}));const l=document.getElementById("wp-erp-invoices-root");l&&(0,n.H)(l).render((0,p.jsx)(C,{}));const i=document.getElementById("wp-erp-expenses-root");i&&(0,n.H)(i).render((0,p.jsx)(N,{}));const o=document.getElementById("wp-erp-food-pass-root");o&&(0,n.H)(o).render((0,p.jsx)(R,{}));const d=document.getElementById("wp-erp-donations-root");d&&(0,n.H)(d).render((0,p.jsx)(M,{}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",H):H()})();